language: java
sudo: true
before_install:
  - chmod +x mvnw

addons:
  sonarcloud:
    organization: "esgi-4-al"
jobs:
  include:
    - stage: test
    name: "Test..."
    script:
      - ./mvnw clean test
    - stage: build
      name: "Build..."
      script:
        - ./mvnw clean package -DskipTests
        - ./mvnw clean verify sonar:sonar -Pcoverage -Dsonar.projectKey=UgoPerniceni_cocotton-backend -Dsonar.login=${SONAR_TOKEN}
    - stage: deploy
      name: "Deploy..."
